# 如何防止植入链接被刷 UV：把"点击 UV"升级为"有效 UV"

我们常见的 CPC 链接大概长这样：

`https://abc.com/landpage-tech/?source=CPC&plan=CPC&media=ABC&pageName=landpage-tech&other03`

参数清晰、链路简单、投放和归因都方便，但也带来一个现实问题：**它太容易被复制，也太容易被脚本模拟**。如果你的统计口径只看"访问次数/UV"，那对方甚至不需要控制你的站点，只要能发请求就能把数字"做漂亮"。

要解决这个问题，核心思路只有一句话：
**不要结算"来过的人"，只结算"完成了行为的人"。**

下面是一个在工程上最常用、性价比最高的分层方案。

---

## 1）先认清：哪些指标天生不可信

很多团队第一反应是"看 Referer、看 IP、看 UA"。这些当然能用，但只能当辅助信号。

* **Referer**：浏览器会裁剪，脚本也能伪造
* **IP**：代理池成本极低，移动网络还会自然漂移
* **User-Agent**：完全可伪造

所以它们不适合作为"结算依据"，最多用于**异常提示**。

---

## 2）把口径从"UV"改成"有效 UV"

你前面提到的规则其实已经走在正确方向上了：

* **仅统计新访客**（按百度统计的通用定义：首次识别到的访问标识）
* **停留 < 20 秒不算有效**

这两条的意义是：
把最常见的两类噪声——**重复点击**和**误触/秒跳**——先过滤掉。

但如果只靠前端统计工具（比如 Umami/BA/GA）来判"新访客 + 20 秒"，依然会被脚本用"清 Cookie + 等待 20 秒"绕过去。你需要再加一层：**服务端确认**。

---

## 3）最关键的一步：引入"一次性会话票据"，只对票据结算

这里不需要上复杂风控，也不需要识别真人，只需要把"刷 UV"的门槛从"发一个 GET 请求"提高到"跑完一套会话流程"。

### 核心做法（建议你就这么做）

1. **落地页加载时，不立刻记为有效 UV**
2. 前端先向服务端请求一个一次性 token（会话票据）

   * token 有效期：5–10 分钟
   * token 绑定：media / plan / other / 当下时间窗 /（可选）UA 哈希
3. 只有当用户满足"有效行为"（例如停留 ≥20s 或滚动/交互）后，前端带 token 调用确认接口
4. 服务端确认成功，才把这次访问计入"有效 UV"

一句话总结：
**没有 token 的访问，永远只是候选流量；只有确认过 token 的，才算有效 UV。**

为什么这招有效？
因为绝大多数刷量脚本能轻松"请求页面"，但很少愿意稳定跑完"拿 token → 等待/交互 → 回传确认 → 去重校验"这套流程。刷量成本一下子就上来了。

---

## 4）"20 秒"之外，再加两个更便宜的行为信号

为了进一步提高刷量成本，你可以在"停留≥20s"之外，再加两个非常轻量的行为门槛（任选其一即可，别搞太复杂）：

* **滚动阈值**：滚动超过 30% 才能 confirm
* **交互阈值**：发生一次真实交互（click / keydown / pointermove 之一）才 confirm

这两条的作用不是"证明真人"，而是过滤掉大量"只等时间"的低成本脚本。

---

## 5）去重与限频：别拦，直接"不结算"

对内容 CPC 最舒服的策略是：**不拦截访问，只影响计费**。你只需要把下面这些明显异常做成"不计入有效 UV"。

建议的去重/限频规则（够用就行）：

* **同 token 只能 confirm 一次**
* **同 visitorId（或 cookieId）在周期内只记 1 个"新访客有效 UV"**
* **同 IP 段在短时间内出现异常峰值：标记为异常，不结算**
* **同 UA 哈希在短时间内产出大量"新访客"：标记为异常，不结算**

注意关键词：**标记 + 不结算**，不要"封禁"。封禁会引发无谓争议，而"不结算"既能控风险又便于对账。

---

## 6）对账底座：把前端统计和服务端日志分工

很多扯皮来自"你看的是 A 指标，我看的是 B 指标"。最稳的做法是：

* 前端统计（Umami/百度统计）：看趋势、看来源结构、看页面表现
* 服务端确认日志：作为**结算口径唯一依据**

你甚至可以把服务端的"有效 UV"导出成一张表（按 media/other 聚合），让对方看得明白：**我们结算的是 confirm 过的那一层，而不是页面浏览。**

---

## 7）把规则写成"能落地、能沟通"的一句话

你可以对外这样说，既不露实现细节，也能立住口径：

> 有效 CPC 以"新访客有效访问"为准：同一访客重复点击不计费；且需满足单次访问停留不少于 20 秒（并完成基本浏览行为）才计入有效量。结算以落地页服务端确认数据为准。

这句话的潜台词很明确：
**刷可以刷，但刷了也未必算。**

---

## 最后的底线认知

* **你无法证明"每一个 UV 都是真人"**
* 但你完全可以做到：
  **"刷量要付出明显成本、并且很容易被判定为无效，不值得刷。"**

这就是内容 CPC 场景里最现实、最有效的"防刷"。

---

## 延伸思考

如果你愿意，你可以把现在的结算口径（新访客 + 20 秒 + 统计确认）直接整理成一份**《首期 CPC 结算规则（对外版 + 内部版）》**，并附一张"候选 UV → 有效 UV → 结算 UV"的漏斗图，拿去跟合作方对齐会特别省事。
